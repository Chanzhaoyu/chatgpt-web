import{X,C as q,w as H,E as J,a as Y,P as ee,Q as ue,Z as le,_ as oe,D as te,v as ae,F as se}from"./element-plus.5b1237d2.js";import{m as ne,n as de,_ as ie,o as re,M as p,p as me,t as pe,f as ce}from"./index.4abee10a.js";import{d as P,r as w,s as O,Z as W,e as z,w as Fe,f as fe,o as m,c as B,U as o,L as t,u,K as E,T as $,R as _,a,a3 as I,a9 as L,O as Ee,S as _e,n as R,Q as C}from"./@vue.50ba5cf8.js";import{c as ve}from"./@vueuse.e5441eed.js";import{m as Ce,a as be,b as Ve,c as Be}from"./menu.891f00fe.js";import{P as De}from"./index.9779dcb9.js";const ye={class:"icon-select"},he={class:"flex justify-between"},Ae=a("div",{class:"mb-3"},"\u8BF7\u9009\u62E9\u56FE\u6807",-1),Te=["onClick"],ke={class:"h-[280px]"},Ue={class:"flex flex-wrap"},ge={key:0,class:"flex items-center"},we=P({__name:"picker",props:{modelValue:{default:""},disabled:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(D,{emit:y}){const h=w(0),T=[{name:"element\u56FE\u6807",icons:ne()},{name:"\u672C\u5730\u56FE\u6807",icons:de()}],b=O(),s=W({inputValue:"",popoverVisible:!1,popoverWidth:0,mouseoverSelect:!1,inputFocus:!1}),x=()=>{s.inputFocus=s.popoverVisible=!0},U=()=>{s.inputFocus=!1,s.popoverVisible=s.mouseoverSelect},N=c=>{s.mouseoverSelect=s.popoverVisible=!1,y("update:modelValue",c),y("change",c)},l=()=>{y("update:modelValue",""),y("change","")},S=z(()=>{var f,V;const c=(V=(f=T[h.value])==null?void 0:f.icons)!=null?V:[];if(!s.inputValue)return c;const d=s.inputValue.toLowerCase();return c.filter(A=>{if(A.toLowerCase().indexOf(d)!==-1)return A})}),g=()=>{R(()=>{var d;const c=(d=b.value)==null?void 0:d.$el.offsetWidth;s.popoverWidth=c<300?300:c})};return ve(document.body,"click",()=>{s.popoverVisible=!!(s.inputFocus||s.mouseoverSelect)}),Fe(()=>s.popoverVisible,async c=>{var d,f;await R(),c?(d=b.value)==null||d.focus():(f=b.value)==null||f.blur()}),fe(()=>{g()}),(c,d)=>{const f=ie,V=H,A=J,M=Y,i=X;return m(),B("div",ye,[o(i,{trigger:"contextmenu",visible:s.popoverVisible,"onUpdate:visible":d[3]||(d[3]=e=>s.popoverVisible=e),width:s.popoverWidth},{reference:t(()=>[o(u(q),{ref_key:"inputRef",ref:b,modelValue:s.inputValue,"onUpdate:modelValue":d[2]||(d[2]=e=>s.inputValue=e),modelModifiers:{trim:!0},placeholder:"\u641C\u7D22\u56FE\u6807",autofocus:!1,disabled:D.disabled,onFocus:x,onBlur:U,clearable:""},{prepend:t(()=>[D.modelValue?(m(),B("div",ge,[o(M,{class:"flex-1 w-20",content:D.modelValue,placement:"top"},{default:t(()=>[(m(),E(f,{class:"mr-1",key:D.modelValue,name:D.modelValue,size:16},null,8,["name"]))]),_:1},8,["content"])])):(m(),B($,{key:1},[_("\u65E0")],64))]),append:t(()=>[o(V,null,{default:t(()=>[o(f,{name:"el-icon-Close",size:18,onClick:l})]),_:1})]),_:1},8,["modelValue","disabled"])]),default:t(()=>[a("div",{onMouseover:d[0]||(d[0]=I(e=>s.mouseoverSelect=!0,["stop"])),onMouseout:d[1]||(d[1]=I(e=>s.mouseoverSelect=!1,["stop"]))},[a("div",null,[a("div",he,[Ae,a("div",null,[(m(),B($,null,L(T,(e,r)=>a("span",{key:r,class:Ee(["cursor-pointer text-sm ml-2",{"text-primary":r==u(h)}]),onClick:v=>h.value=r},_e(e.name),11,Te)),64))])]),a("div",ke,[o(A,null,{default:t(()=>[a("div",Ue,[(m(!0),B($,null,L(u(S),e=>(m(),B("div",{key:e,class:"m-1"},[o(V,{onClick:r=>N(e)},{default:t(()=>[o(f,{name:e,size:18},null,8,["name"])]),_:2},1032,["onClick"])]))),128))])]),_:1})])])],32)]),_:1},8,["visible","width"])])}}}),xe={class:"edit-popup"},Ne={class:"flex-1"},Se=a("div",{class:"form-tips"}," \u8BBF\u95EE\u7684\u8DEF\u7531\u5730\u5740\uFF0C\u5982\uFF1A`admin`\uFF0C\u5982\u5916\u7F51\u5730\u5740\u9700\u5185\u94FE\u8BBF\u95EE\u5219\u4EE5`http(s)://`\u5F00\u5934 ",-1),Me={class:"flex-1"},$e=a("div",{class:"form-tips"}," \u8BBF\u95EE\u7684\u7EC4\u4EF6\u8DEF\u5F84\uFF0C\u5982\uFF1A`permission/admin/index`\uFF0C\u9ED8\u8BA4\u5728`views`\u76EE\u5F55\u4E0B ",-1),Oe={class:"flex-1"},Ie=a("div",{class:"form-tips"}," \u8BBF\u95EE\u8BE6\u60C5\u9875\u9762\uFF0C\u7F16\u8F91\u9875\u9762\u65F6\uFF0C\u83DC\u5355\u9AD8\u4EAE\u663E\u793A\uFF0C\u5982`/consumer/lists` ",-1),Le={class:"flex-1"},Re=a("div",{class:"form-tips"}," \u5C06\u4F5C\u4E3Aserver\u7AEFAPI\u9A8C\u6743\u4F7F\u7528\uFF0C\u5982`system:admin:list`\uFF0C\u8BF7\u8C28\u614E\u4FEE\u6539 ",-1),qe={class:"flex-1"},Pe=a("div",{class:"form-tips"},' \u8BBF\u95EE\u8DEF\u7531\u7684\u9ED8\u8BA4\u4F20\u9012\u53C2\u6570\uFF0C\u5982\uFF1A`{"id": 1, "name": "admin"}`\u6216`id=1&name=admin` ',-1),We=a("div",{class:"form-tips"},"\u9009\u62E9\u7F13\u5B58\u5219\u4F1A\u88AB`keep-alive`\u7F13\u5B58",-1),ze=a("div",{class:"form-tips"}," \u9009\u62E9\u9690\u85CF\u5219\u8DEF\u7531\u5C06\u4E0D\u4F1A\u51FA\u73B0\u5728\u4FA7\u8FB9\u680F\uFF0C\u4F46\u4ECD\u7136\u53EF\u4EE5\u8BBF\u95EE ",-1),Ge=a("div",{class:"form-tips"},"\u9009\u62E9\u505C\u7528\u5219\u8DEF\u7531\u5C06\u4E0D\u4F1A\u51FA\u73B0\u5728\u4FA7\u8FB9\u680F\uFF0C\u4E5F\u4E0D\u80FD\u88AB\u8BBF\u95EE",-1),Ke=a("div",{class:"form-tips"},"\u6570\u503C\u8D8A\u5927\u8D8A\u6392\u524D",-1),Ye=P({__name:"edit",emits:["success","close"],setup(D,{expose:y,emit:h}){const T=O(),b=O(),s=w("add"),x=z(()=>s.value=="edit"?"\u7F16\u8F91\u83DC\u5355":"\u65B0\u589E\u83DC\u5355"),U=w(re()),N=(i,e)=>{const r=i?U.value.filter(v=>v.toLowerCase().includes(i.toLowerCase())):U.value;e(r.map(v=>({value:v})))},l=W({id:"",pid:0,menuType:p.CATALOGUE,menuIcon:"",menuName:"",menuSort:0,paths:"",perms:"",component:"",selected:"",params:"",isCache:1,isShow:1,isDisable:0}),S={pid:[{required:!0,message:"\u8BF7\u9009\u62E9\u7236\u7EA7\u83DC\u5355",trigger:["blur","change"]}],menuName:[{required:!0,message:"\u8BF7\u8F93\u5165\u83DC\u5355\u540D\u79F0",trigger:"blur"}],paths:[{required:!0,message:"\u8BF7\u8F93\u5165\u8DEF\u7531\u5730\u5740",trigger:"blur"}],component:[{required:!0,message:"\u8BF7\u8F93\u5165\u7EC4\u4EF6\u5730\u5740",trigger:"blur"}]},g=w([]),c=async()=>{const i=await Ce(),e={id:0,menuName:"\u9876\u7EA7",children:[]};e.children=me(pe(i).filter(r=>r.menuType!=p.BUTTON)),g.value.push(e)},d=async()=>{var i,e;await((i=T.value)==null?void 0:i.validate()),s.value=="edit"?await be(l):await Ve(l),(e=b.value)==null||e.close(),ce.msgSuccess("\u64CD\u4F5C\u6210\u529F"),h("success")},f=(i="add")=>{var e;s.value=i,(e=b.value)==null||e.open()},V=i=>{for(const e in l)i[e]!=null&&i[e]!=null&&(l[e]=i[e])},A=async i=>{const e=await Be({id:i.id});V(e)},M=()=>{h("close")};return c(),y({open:f,setFormData:V,getDetail:A}),(i,e)=>{const r=ee,v=ue,F=te,G=le,k=q,K=we,Q=oe,Z=ae,j=se;return m(),B("div",xe,[o(De,{ref_key:"popupRef",ref:b,title:u(x),async:!0,width:"550px",onConfirm:d,onClose:M},{default:t(()=>[o(j,{ref_key:"formRef",ref:T,model:u(l),"label-width":"80px",rules:S},{default:t(()=>[o(F,{label:"\u83DC\u5355\u7C7B\u578B",prop:"menuType",required:""},{default:t(()=>[o(v,{modelValue:u(l).menuType,"onUpdate:modelValue":e[0]||(e[0]=n=>u(l).menuType=n)},{default:t(()=>[o(r,{label:u(p).CATALOGUE},{default:t(()=>[_("\u76EE\u5F55")]),_:1},8,["label"]),o(r,{label:u(p).MENU},{default:t(()=>[_("\u83DC\u5355")]),_:1},8,["label"]),o(r,{label:u(p).BUTTON},{default:t(()=>[_("\u6309\u94AE")]),_:1},8,["label"])]),_:1},8,["modelValue"])]),_:1}),o(F,{label:"\u7236\u7EA7\u83DC\u5355",prop:"pid"},{default:t(()=>[o(G,{class:"flex-1",modelValue:u(l).pid,"onUpdate:modelValue":e[1]||(e[1]=n=>u(l).pid=n),data:u(g),clearable:"","node-key":"id",props:{label:"menuName"},"default-expand-all":!0,placeholder:"\u8BF7\u9009\u62E9\u7236\u7EA7\u83DC\u5355","check-strictly":""},null,8,["modelValue","data"])]),_:1}),o(F,{label:"\u83DC\u5355\u540D\u79F0",prop:"menuName"},{default:t(()=>[o(k,{modelValue:u(l).menuName,"onUpdate:modelValue":e[2]||(e[2]=n=>u(l).menuName=n),placeholder:"\u8BF7\u8F93\u5165\u83DC\u5355\u540D\u79F0",clearable:""},null,8,["modelValue"])]),_:1}),u(l).menuType!==u(p).BUTTON?(m(),E(F,{key:0,label:"\u83DC\u5355\u56FE\u6807",prop:"menuIcon"},{default:t(()=>[o(K,{class:"flex-1",modelValue:u(l).menuIcon,"onUpdate:modelValue":e[3]||(e[3]=n=>u(l).menuIcon=n)},null,8,["modelValue"])]),_:1})):C("",!0),u(l).menuType!==u(p).BUTTON?(m(),E(F,{key:1,label:"\u8DEF\u7531\u8DEF\u5F84",prop:"paths"},{default:t(()=>[a("div",Ne,[o(k,{modelValue:u(l).paths,"onUpdate:modelValue":e[4]||(e[4]=n=>u(l).paths=n),placeholder:"\u8BF7\u8F93\u5165\u8DEF\u7531\u8DEF\u5F84",clearable:""},null,8,["modelValue"]),Se])]),_:1})):C("",!0),u(l).menuType===u(p).MENU?(m(),E(F,{key:2,label:"\u7EC4\u4EF6\u8DEF\u5F84",prop:"component"},{default:t(()=>[a("div",Me,[o(Q,{class:"w-full",modelValue:u(l).component,"onUpdate:modelValue":e[5]||(e[5]=n=>u(l).component=n),"fetch-suggestions":N,clearable:"",placeholder:"\u8BF7\u8F93\u5165\u7EC4\u4EF6\u8DEF\u5F84"},null,8,["modelValue"]),$e])]),_:1})):C("",!0),u(l).menuType===u(p).MENU?(m(),E(F,{key:3,label:"\u9009\u4E2D\u83DC\u5355",prop:"selected"},{default:t(()=>[a("div",Oe,[o(k,{modelValue:u(l).selected,"onUpdate:modelValue":e[6]||(e[6]=n=>u(l).selected=n),placeholder:"\u8BF7\u8F93\u5165\u8DEF\u7531\u8DEF\u5F84",clearable:""},null,8,["modelValue"]),Ie])]),_:1})):C("",!0),u(l).menuType!==u(p).CATALOGUE?(m(),E(F,{key:4,label:"\u6743\u9650\u5B57\u7B26",prop:"perms"},{default:t(()=>[a("div",Le,[o(k,{modelValue:u(l).perms,"onUpdate:modelValue":e[7]||(e[7]=n=>u(l).perms=n),placeholder:"\u8BF7\u8F93\u5165\u6743\u9650\u5B57\u7B26",clearable:""},null,8,["modelValue"]),Re])]),_:1})):C("",!0),u(l).menuType===u(p).MENU?(m(),E(F,{key:5,label:"\u8DEF\u7531\u53C2\u6570",prop:"params"},{default:t(()=>[a("div",null,[a("div",qe,[o(k,{modelValue:u(l).params,"onUpdate:modelValue":e[8]||(e[8]=n=>u(l).params=n),placeholder:"\u8BF7\u8F93\u5165\u8DEF\u7531\u53C2\u6570",clearable:""},null,8,["modelValue"])]),Pe])]),_:1})):C("",!0),u(l).menuType===u(p).MENU?(m(),E(F,{key:6,label:"\u662F\u5426\u7F13\u5B58",prop:"isCache",required:""},{default:t(()=>[a("div",null,[o(v,{modelValue:u(l).isCache,"onUpdate:modelValue":e[9]||(e[9]=n=>u(l).isCache=n)},{default:t(()=>[o(r,{label:1},{default:t(()=>[_("\u7F13\u5B58")]),_:1}),o(r,{label:0},{default:t(()=>[_("\u4E0D\u7F13\u5B58")]),_:1})]),_:1},8,["modelValue"]),We])]),_:1})):C("",!0),u(l).menuType!==u(p).BUTTON?(m(),E(F,{key:7,label:"\u662F\u5426\u663E\u793A",prop:"isShow",required:""},{default:t(()=>[a("div",null,[o(v,{modelValue:u(l).isShow,"onUpdate:modelValue":e[10]||(e[10]=n=>u(l).isShow=n)},{default:t(()=>[o(r,{label:1},{default:t(()=>[_("\u663E\u793A")]),_:1}),o(r,{label:0},{default:t(()=>[_("\u9690\u85CF")]),_:1})]),_:1},8,["modelValue"]),ze])]),_:1})):C("",!0),u(l).menuType!==u(p).BUTTON?(m(),E(F,{key:8,label:"\u83DC\u5355\u72B6\u6001",prop:"isDisable",required:""},{default:t(()=>[a("div",null,[o(v,{modelValue:u(l).isDisable,"onUpdate:modelValue":e[11]||(e[11]=n=>u(l).isDisable=n)},{default:t(()=>[o(r,{label:0},{default:t(()=>[_("\u6B63\u5E38")]),_:1}),o(r,{label:1},{default:t(()=>[_("\u505C\u7528")]),_:1})]),_:1},8,["modelValue"]),Ge])]),_:1})):C("",!0),o(F,{label:"\u83DC\u5355\u6392\u5E8F",prop:"menuSort"},{default:t(()=>[a("div",null,[o(Z,{modelValue:u(l).menuSort,"onUpdate:modelValue":e[12]||(e[12]=n=>u(l).menuSort=n),max:9999},null,8,["modelValue"]),Ke])]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])])}}});export{Ye as _};
